<section><!--@stagger-->

    <div fxLayout="column" >
  
      <div class="card overflow-auto mt-5 " style="box-shadow: var(--elevation-z0);border: 0px solid rgba(0, 0, 0, 0.125);">
        <form fxLayout="row" fxFlex.gt-xs fxLayout.xs="column" fxLayoutAlign="start center"
        fxLayoutAlign.sm="start start" fxItemAlign="center" fxItemAlign.xs="start" fxLayoutGap="24px"
        fxLayoutGap.xs="12px" [formGroup]="filters">

          <mat-form-field appearance="outline" fxFlexAlign.xs="stretch" class="bold-form " floatLabel="always">
            <mat-label>Fecha Inicial</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="date" placeholder="Rango de fecha"
                autocomplete="off"  (dateChange)="dateChange($event)"/>
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="outline" fxFlexAlign.xs="stretch" class="bold-form" floatLabel="always">
            <mat-label>Fecha Inicial</mat-label>
            <input matInput [matDatepicker]="picker2" formControlName="date2" placeholder="Rango de fecha"
                autocomplete="off" (dateChange)="dateChange($event)"/>
            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
            <mat-datepicker #picker2></mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="outline" fxFlexAlign.xs="stretch" class="bold-form"
              floatLabel="always">
              <mat-label>Cliente</mat-label>
              <input matInput  #search placeholder="Nombre del  Cliente..."
                  formControlName="search" (keyup)="searchKeyUp($event)"/>
          </mat-form-field>
        </form>

        </div>

        <div class="cont-tabla">
            <table @stagger class="w-full"  mat-table
                matSort [dataSource]="dataSource">
                <ng-container matColumnDef="id_pedido">
                  <th mat-header-cell *matHeaderCellDef> Id pedido </th>
                  <td mat-cell *matCellDef="let element" > {{element.id}} </td>
                </ng-container>
  
                <ng-container matColumnDef="cliente">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> Cliente </th>
                  <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                </ng-container>
  
                <ng-container matColumnDef="fecha_despacho">
                  <th mat-header-cell *matHeaderCellDef> Conductor </th>
                  <td mat-cell *matCellDef="let element" class="campo-normal"> {{ element.conductor }} </td>
                </ng-container>

                <ng-container matColumnDef="ultimo_pago" style="width: 60px;">
                  <th mat-header-cell *matHeaderCellDef> Fecha despacho</th>
                  <td mat-cell *matCellDef="let element"><p class="cortar_1">{{ element.date }}</p></td>
                </ng-container>

                <ng-container matColumnDef="hora_despacho" style="width: 60px;">
                  <th mat-header-cell *matHeaderCellDef> Hora despacho</th>
                  <td mat-cell *matCellDef="let element"><p class="cortar_1">{{ element.hora_despacho }}</p></td>
                </ng-container>
  
                <ng-container matColumnDef="hora_llegada">
                  <th mat-header-cell *matHeaderCellDef> Hora llegada </th>
                  <td mat-cell *matCellDef="let element" class="campo-normal"> {{ element.hora_llegada }} </td>
                </ng-container>
  
                <ng-container matColumnDef="valor">
                  <th mat-header-cell *matHeaderCellDef> Hora descargue </th>
                  <td mat-cell *matCellDef="let element" class="campo-normal"> {{ element.hora_descargue }} </td>
                </ng-container>

                <ng-container matColumnDef="estado">
                    <th mat-header-cell *matHeaderCellDef> Hora fin </th>
                    <td mat-cell *matCellDef="let element" class="campo-normal"><span>{{ element.hora_fin }}</span> </td>
                </ng-container>
  
                <ng-container matColumnDef="acciones">
                  <th mat-header-cell *matHeaderCellDef> Estado </th>
                  <td mat-cell *matCellDef="let element" class="campo-normal">

                    <span [ngStyle]="{'background-color': element.status == 1 ? 'blue' :element.status == 2 ? 'orange' : element.status == 3 ? '#1565C0' : element.status == 4 ? 'red' : element.status == 5 ? 'orange' : element.status == 6 ? 'green': ' '}" style="border-radius:10px;width: 100%;padding:10px; font-weight: bold;color: white;cursor: pointer;" (click)="estadoDespachoModal(element.id, element.status)">
                      {{ element.status ==1 ? 'Programado': element.status ==2 ? 'Revision' : element.status == 3 ? 'Despachado' : element.status == 4 ? 'Cancelada' : element.status == 5 ? 'En descarga' : element.status == 6 ? 'Finalizado' : '---'}}
                    </span>


                    <span (click)="setHora(element.id, 1)" [hidden]="element.hora_despacho || element.status != 3 ? true : false" class="tag">Hora Despacho</span><!---->
                    <span (click)="setHora(element.id, 2)" [hidden]="!element.hora_despacho || element.hora_llegada ? true : false" class="tag">Hora llegada</span><!--[hidden]="element.hora_descargue || element.status != 3 ? true : false"-->
                    <span (click)="setHora(element.id, 3)" [hidden]="!element.hora_llegada || element.hora_descargue ? true : false" class="tag">Hora descargue</span><!--[hidden]="element.hora_descargue || element.status != 3 ? true : false"-->
                    <span [hidden]="!element.hora_descargue || element.hora_fin ? true : false" (click)="saveHoraFin(element.id)" class="tag">fin descargue</span><!--[hidden]="element.hora_descargue && !element.hora_fin? false:!element.hora_descargue && !element.hora_fin?true:element.hora_descargue && element.hora_fin?true:false"-->
                  </td>
                </ng-container>
  
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
          </div>
  
      </div>
  </section>